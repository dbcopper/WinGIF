# Repository Guidelines

## Project Structure & Module Organization
- `crates/app/src` contains two entry points (`main.rs` classic Win32 UI, `main_egui.rs` modern egui UI), plus `ui.rs`, `ui_egui.rs`, `tray.rs`, and `state.rs`.
- `crates/overlay/src` implements the selection overlay window, outline rendering, screenshot preview, and render loop (`window.rs`, `outline.rs`, `screenshot.rs`, `selection.rs`, `render.rs`).
- `crates/capture_wgc/src` contains the Windows Graphics Capture + D3D11 capture pipeline (`capture.rs`, `d3d11.rs`, `frame.rs`).
- `crates/export/src` handles GIF/PNG export (`gif.rs`, `png.rs`).
- `assets/` stores app assets like `icon.ico`.
- `target/` is generated by Cargo and should not be edited or committed.

## Build, Test, and Development Commands
Run from the repository root:
```cmd
cargo build --release                       :: release build
cargo run --release                         :: run default binary (tinycapture-modern)
cargo run -p app --bin tinycapture --release :: run classic Win32 UI
cargo run -p app --bin tinycapture-modern --release :: run modern egui UI
cargo test                                  :: run all tests
```
These are standard Cargo commands; use the same commands in PowerShell or cmd.exe.

## Coding Style & Naming Conventions
- Rust 2021 edition (workspace-level). Keep code formatted with `rustfmt` defaults.
- Indentation: 4 spaces; line endings: Windows CRLF is fine, but be consistent within a file.
- Naming: `snake_case` for modules/functions/vars, `PascalCase` for types, `SCREAMING_SNAKE_CASE` for constants.
- Keep Windows API interop localized to the relevant crate/module to avoid leaking platform details.

## Testing Guidelines
- There are no tests in the repo yet. Add unit tests in `crates/*/src` with `#[cfg(test)]` or integration tests in `crates/<name>/tests`.
- Prefer tests around state transitions, capture boundaries, and export behaviors.
- Run `cargo test` before opening a PR.

## Commit & Pull Request Guidelines
- This checkout does not include a `.git` history, so no commit convention is established here.
- If you are setting the convention, keep messages short and imperative (e.g., `capture: fix frame resize`).
- PRs should include: a brief description, testing notes, and screenshots/GIFs for UI-visible changes.

## Security & Configuration Notes
- The app is Windows-only and depends on Windows 10 1903+ Graphics Capture APIs; keep platform checks in mind.
- Do not commit build artifacts (`target/`) or local environment files.
